plugins {
    id "com.dorongold.task-tree" version "2.1.0"
    alias libs.plugins.quilt.loom apply false
    id 'org.cadixdev.licenser' version '0.6.1' apply false
    id 'io.github.groovymc.modsdotgroovy' version '1.1.0' apply false
}

subprojects {
    apply plugin: 'groovy'
    apply plugin: 'maven-publish'
    apply plugin: libs.plugins.quilt.loom.get().pluginId
    apply plugin: 'org.cadixdev.licenser'
    apply plugin: 'io.github.groovymc.modsdotgroovy'

    jar {
        from(rootProject.file("LICENSE")) {
            rename { "${it}-${archivesBaseName}" }
        }
    }

    license {
        header = rootProject.file('header.txt')
    }

    modsDotGroovy {
        dslVersion = '1.1.1'
        platform 'quilt'
    }

    dependencies {
        minecraft libs.minecraft
        mappings loom.layered() {
            officialMojangMappings()
            parchment("org.parchmentmc.data:parchment-${libs.versions.parchment.minecraft.get()}:${libs.versions.parchment.mappings.get()}@zip")
        }
        modImplementation libs.quilt.loader

        modImplementation libs.qsl

        modImplementation libs.groovy
    }

    tasks.withType(JavaCompile).configureEach {
        it.options.encoding = "UTF-8"
        it.options.release = 17
    }

    java {
        sourceCompatibility = JavaVersion.VERSION_17
        targetCompatibility = JavaVersion.VERSION_17
        withSourcesJar()
        withJavadocJar()
    }
}
